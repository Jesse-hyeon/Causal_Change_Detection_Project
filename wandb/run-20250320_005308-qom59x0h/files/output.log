[I 2025-03-20 00:53:09,425] A new study created in memory with name: no-name-04cc33b4-7d3b-4f09-a5de-6bdc3aca980c
--- TS-CV Fold 1/1 ---
Use CPU
train 1979
val 1
test 192
Epoch: 1 cost time: 1.8576929569244385
Epoch: 1, Steps: 30 | Train Loss: 1.0324721 Vali Loss: 5.2369165 Test Loss: 7.0678350
Validation loss decreased (inf --> 5.236917).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 1.5496556758880615
Epoch: 2, Steps: 30 | Train Loss: 0.7589188 Vali Loss: 4.1069918 Test Loss: 5.8196970
Validation loss decreased (5.236917 --> 4.106992).  Saving model ...
Updating learning rate to 5e-05
Epoch: 3 cost time: 1.4595508575439453
Epoch: 3, Steps: 30 | Train Loss: 0.7028432 Vali Loss: 3.8291504 Test Loss: 5.5039507
Validation loss decreased (4.106992 --> 3.829150).  Saving model ...
Updating learning rate to 2.5e-05
Epoch: 4 cost time: 1.7739660739898682
Epoch: 4, Steps: 30 | Train Loss: 0.6678352 Vali Loss: 3.7154651 Test Loss: 5.3765376
Validation loss decreased (3.829150 --> 3.715465).  Saving model ...
Updating learning rate to 1.25e-05
Epoch: 5 cost time: 1.5516831874847412
Epoch: 5, Steps: 30 | Train Loss: 0.6494035 Vali Loss: 3.6601338 Test Loss: 5.3153476
Validation loss decreased (3.715465 --> 3.660134).  Saving model ...
Updating learning rate to 6.25e-06
val 1
Fold 1 validation loss: 3.6601
Average validation loss over 1 folds: 3.6601
[I 2025-03-20 00:53:19,121] Trial 0 finished with value: 3.6601338386535645 and parameters: {'d_model': 640, 'n_heads': 4, 'e_layers': 3, 'd_layers': 2, 'd_ff': 1024, 'dropout': 0.06202203969098735, 'batch_size': 64, 'activation': 'gelu'}. Best is trial 0 with value: 3.6601338386535645.
Best hyperparameters: {'d_model': 640, 'n_heads': 4, 'e_layers': 3, 'd_layers': 2, 'd_ff': 1024, 'dropout': 0.06202203969098735, 'batch_size': 64, 'activation': 'gelu'}
Final training model
Use CPU
train 2069
val 192
test 192
Epoch: 1 cost time: 1.4975180625915527
Epoch: 1, Steps: 32 | Train Loss: 1.1639503 Vali Loss: 5.0359305 Test Loss: 6.3679683
Validation loss decreased (inf --> 5.035931).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 1.5089290142059326
Epoch: 2, Steps: 32 | Train Loss: 0.8267874 Vali Loss: 3.7562484 Test Loss: 5.1989664
Validation loss decreased (5.035931 --> 3.756248).  Saving model ...
Updating learning rate to 5e-05
Epoch: 3 cost time: 1.5055298805236816
Epoch: 3, Steps: 32 | Train Loss: 0.7518309 Vali Loss: 3.4140466 Test Loss: 4.9167508
Validation loss decreased (3.756248 --> 3.414047).  Saving model ...
Updating learning rate to 2.5e-05
Epoch: 4 cost time: 1.7139458656311035
Epoch: 4, Steps: 32 | Train Loss: 0.7018549 Vali Loss: 3.2632093 Test Loss: 4.8016049
Validation loss decreased (3.414047 --> 3.263209).  Saving model ...
Updating learning rate to 1.25e-05
Epoch: 5 cost time: 1.7254457473754883
Epoch: 5, Steps: 32 | Train Loss: 0.6748151 Vali Loss: 3.1883069 Test Loss: 4.7459025
Validation loss decreased (3.263209 --> 3.188307).  Saving model ...
Updating learning rate to 6.25e-06
test 192
preds shape:  (192, 1, 90, 1)
trues shape:  (192, 1, 90, 1)
mape:0.2574, mae:500.24, d_stat:47.42
Final model training and testing complete.
