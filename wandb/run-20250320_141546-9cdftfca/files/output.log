[I 2025-03-20 14:15:46,950] A new study created in memory with name: no-name-febf7b42-45dd-4c25-96a2-30fc99a4fcaf
--- TS-CV Fold 1/1 ---
Use CPU
start training
train 1979
val 1
test 192
Epoch: 1 cost time: 182.40903282165527
Epoch: 1, Steps: 30 | Train Loss: 0.2191831 Vali Loss: 1.2311456 Test Loss: 1.0084610
Validation loss decreased (inf --> 1.231146).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 184.81852388381958
Epoch: 2, Steps: 30 | Train Loss: 0.2380653 Vali Loss: 0.9242588 Test Loss: 0.7993347
Validation loss decreased (1.231146 --> 0.924259).  Saving model ...
Updating learning rate to 5e-05
Epoch: 3 cost time: 185.45916891098022
Epoch: 3, Steps: 30 | Train Loss: 0.2108543 Vali Loss: 0.1777793 Test Loss: 0.3609808
Validation loss decreased (0.924259 --> 0.177779).  Saving model ...
Updating learning rate to 2.5e-05
Epoch: 4 cost time: 185.38105702400208
Epoch: 4, Steps: 30 | Train Loss: 0.1561883 Vali Loss: 0.1302744 Test Loss: 0.3711015
Validation loss decreased (0.177779 --> 0.130274).  Saving model ...
Updating learning rate to 1.25e-05
Epoch: 5 cost time: 2568.209958076477
Epoch: 5, Steps: 30 | Train Loss: 0.1418671 Vali Loss: 0.0770951 Test Loss: 0.3719969
Validation loss decreased (0.130274 --> 0.077095).  Saving model ...
Updating learning rate to 6.25e-06
val 1
Fold 1 validation loss: 0.0771
Average validation loss over 1 folds: 0.0771
[I 2025-03-20 15:11:02,672] Trial 0 finished with value: 0.07709508389234543 and parameters: {'d_model': 640, 'n_heads': 16, 'e_layers': 1, 'd_layers': 2, 'd_ff': 2048, 'dropout': 0.4894412317099395, 'batch_size': 64, 'activation': 'gelu'}. Best is trial 0 with value: 0.07709508389234543.
Best hyperparameters: {'d_model': 640, 'n_heads': 16, 'e_layers': 1, 'd_layers': 2, 'd_ff': 2048, 'dropout': 0.4894412317099395, 'batch_size': 64, 'activation': 'gelu'}
Final training model
Use CPU
start training
train 2069
val 192
test 192
Epoch: 1 cost time: 2004.4503569602966
Epoch: 1, Steps: 32 | Train Loss: 0.2150802 Vali Loss: 0.7718658 Test Loss: 0.4543386
Validation loss decreased (inf --> 0.771866).  Saving model ...
Updating learning rate to 0.0001
