[I 2025-03-20 00:52:23,379] A new study created in memory with name: no-name-9e8e0370-4472-4a1e-8275-b7600d720b69
--- TS-CV Fold 1/1 ---
Use CPU
train 1979
val 1
test 192
Epoch: 1 cost time: 1.3870038986206055
Epoch: 1, Steps: 30 | Train Loss: 0.9411864 Vali Loss: 4.4922919 Test Loss: 7.0776503
Validation loss decreased (inf --> 4.492292).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 1.314903974533081
Epoch: 2, Steps: 30 | Train Loss: 0.6192936 Vali Loss: 3.4996490 Test Loss: 5.9683022
Validation loss decreased (4.492292 --> 3.499649).  Saving model ...
Updating learning rate to 5e-05
Epoch: 3 cost time: 1.4887051582336426
Epoch: 3, Steps: 30 | Train Loss: 0.5316388 Vali Loss: 3.1529562 Test Loss: 5.6003787
Validation loss decreased (3.499649 --> 3.152956).  Saving model ...
Updating learning rate to 2.5e-05
Epoch: 4 cost time: 1.4819929599761963
Epoch: 4, Steps: 30 | Train Loss: 0.4864157 Vali Loss: 2.9973605 Test Loss: 5.4460388
Validation loss decreased (3.152956 --> 2.997360).  Saving model ...
Updating learning rate to 1.25e-05
Epoch: 5 cost time: 1.4864528179168701
Epoch: 5, Steps: 30 | Train Loss: 0.4634427 Vali Loss: 2.9208872 Test Loss: 5.3728893
Validation loss decreased (2.997360 --> 2.920887).  Saving model ...
Updating learning rate to 6.25e-06
val 1
Fold 1 validation loss: 2.9209
Average validation loss over 1 folds: 2.9209
[I 2025-03-20 00:52:32,394] Trial 0 finished with value: 2.9208872318267822 and parameters: {'d_model': 512, 'n_heads': 2, 'e_layers': 1, 'd_layers': 3, 'd_ff': 4096, 'dropout': 0.39925243892308726, 'batch_size': 64, 'activation': 'gelu'}. Best is trial 0 with value: 2.9208872318267822.
Best hyperparameters: {'d_model': 512, 'n_heads': 2, 'e_layers': 1, 'd_layers': 3, 'd_ff': 4096, 'dropout': 0.39925243892308726, 'batch_size': 64, 'activation': 'gelu'}
Final training model
Use CPU
train 2069
val 192
test 192
Epoch: 1 cost time: 1.7569379806518555
Epoch: 1, Steps: 32 | Train Loss: 1.1520105 Vali Loss: 4.4735253 Test Loss: 6.2349342
Validation loss decreased (inf --> 4.473525).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 1.7765822410583496
Epoch: 2, Steps: 32 | Train Loss: 0.6884920 Vali Loss: 3.0697476 Test Loss: 4.8545871
Validation loss decreased (4.473525 --> 3.069748).  Saving model ...
Updating learning rate to 5e-05
Epoch: 3 cost time: 1.6986100673675537
Epoch: 3, Steps: 32 | Train Loss: 0.5722701 Vali Loss: 2.6580550 Test Loss: 4.5231925
Validation loss decreased (3.069748 --> 2.658055).  Saving model ...
Updating learning rate to 2.5e-05
Epoch: 4 cost time: 1.6297528743743896
Epoch: 4, Steps: 32 | Train Loss: 0.5062648 Vali Loss: 2.4758521 Test Loss: 4.3963356
Validation loss decreased (2.658055 --> 2.475852).  Saving model ...
Updating learning rate to 1.25e-05
Epoch: 5 cost time: 1.535459041595459
Epoch: 5, Steps: 32 | Train Loss: 0.4731885 Vali Loss: 2.3866970 Test Loss: 4.3379421
Validation loss decreased (2.475852 --> 2.386697).  Saving model ...
Updating learning rate to 6.25e-06
test 192
preds shape:  (192, 1, 90, 1)
trues shape:  (192, 1, 90, 1)
mape:0.2459, mae:477.89, d_stat:52.02
Final model training and testing complete.
