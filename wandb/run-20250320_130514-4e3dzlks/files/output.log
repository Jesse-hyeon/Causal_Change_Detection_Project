[I 2025-03-20 13:05:15,534] A new study created in memory with name: no-name-ab7662dd-550e-44c2-b8ee-a2816523ebe9
--- TS-CV Fold 1/2 ---
Use CPU
train 1889
val 1
test 192
Epoch: 1 cost time: 1.7423648834228516
Epoch: 1, Steps: 29 | Train Loss: 0.9118680 Vali Loss: 5.9234686 Test Loss: 9.1201603
Validation loss decreased (inf --> 5.923469).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 1.3293209075927734
Epoch: 2, Steps: 29 | Train Loss: 0.7017514 Vali Loss: 4.8551478 Test Loss: 7.6255919
Validation loss decreased (5.923469 --> 4.855148).  Saving model ...
Updating learning rate to 5e-05
Epoch: 3 cost time: 1.3250267505645752
Epoch: 3, Steps: 29 | Train Loss: 0.6559801 Vali Loss: 4.5625739 Test Loss: 7.1896586
Validation loss decreased (4.855148 --> 4.562574).  Saving model ...
Updating learning rate to 2.5e-05
Epoch: 4 cost time: 1.4558238983154297
Epoch: 4, Steps: 29 | Train Loss: 0.6266844 Vali Loss: 4.4338055 Test Loss: 6.9997636
Validation loss decreased (4.562574 --> 4.433805).  Saving model ...
Updating learning rate to 1.25e-05
Epoch: 5 cost time: 1.3781681060791016
Epoch: 5, Steps: 29 | Train Loss: 0.6111330 Vali Loss: 4.3688922 Test Loss: 6.9059496
Validation loss decreased (4.433805 --> 4.368892).  Saving model ...
Updating learning rate to 6.25e-06
val 1
Fold 1 validation loss: 4.3689
--- TS-CV Fold 2/2 ---
Use CPU
train 1979
val 1
test 192
Epoch: 1 cost time: 1.5018980503082275
Epoch: 1, Steps: 30 | Train Loss: 1.0054913 Vali Loss: 4.9486723 Test Loss: 7.3858507
Validation loss decreased (inf --> 4.948672).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 1.484410047531128
Epoch: 2, Steps: 30 | Train Loss: 0.7302852 Vali Loss: 3.8912313 Test Loss: 6.0108769
Validation loss decreased (4.948672 --> 3.891231).  Saving model ...
Updating learning rate to 5e-05
Epoch: 3 cost time: 1.455976963043213
Epoch: 3, Steps: 30 | Train Loss: 0.6752844 Vali Loss: 3.6112115 Test Loss: 5.6250060
Validation loss decreased (3.891231 --> 3.611212).  Saving model ...
Updating learning rate to 2.5e-05
Epoch: 4 cost time: 1.678246021270752
Epoch: 4, Steps: 30 | Train Loss: 0.6402115 Vali Loss: 3.4944272 Test Loss: 5.4626539
Validation loss decreased (3.611212 --> 3.494427).  Saving model ...
Updating learning rate to 1.25e-05
Epoch: 5 cost time: 1.35589599609375
Epoch: 5, Steps: 30 | Train Loss: 0.6215421 Vali Loss: 3.4373243 Test Loss: 5.3837883
Validation loss decreased (3.494427 --> 3.437324).  Saving model ...
Updating learning rate to 6.25e-06
val 1
Fold 2 validation loss: 3.4373
Average validation loss over 2 folds: 3.9031
[I 2025-03-20 13:05:33,136] Trial 0 finished with value: 3.903108239173889 and parameters: {'d_model': 640, 'n_heads': 16, 'e_layers': 1, 'd_layers': 1, 'd_ff': 4096, 'dropout': 0.08323951072705266, 'batch_size': 64, 'activation': 'relu'}. Best is trial 0 with value: 3.903108239173889.
--- TS-CV Fold 1/2 ---
Use CPU
train 1889
val 1
test 192
Epoch: 1 cost time: 1.3582139015197754
Epoch: 1, Steps: 29 | Train Loss: 0.9422889 Vali Loss: 6.5229120 Test Loss: 9.8281940
Validation loss decreased (inf --> 6.522912).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 1.4769010543823242
Epoch: 2, Steps: 29 | Train Loss: 0.7259588 Vali Loss: 5.2295208 Test Loss: 8.0057732
Validation loss decreased (6.522912 --> 5.229521).  Saving model ...
Updating learning rate to 5e-05
Epoch: 3 cost time: 1.501446008682251
Epoch: 3, Steps: 29 | Train Loss: 0.6845632 Vali Loss: 4.9378819 Test Loss: 7.5663042
Validation loss decreased (5.229521 --> 4.937882).  Saving model ...
Updating learning rate to 2.5e-05
Epoch: 4 cost time: 1.3822040557861328
Epoch: 4, Steps: 29 | Train Loss: 0.6543702 Vali Loss: 4.8108888 Test Loss: 7.3780173
Validation loss decreased (4.937882 --> 4.810889).  Saving model ...
Updating learning rate to 1.25e-05
Epoch: 5 cost time: 1.3614628314971924
Epoch: 5, Steps: 29 | Train Loss: 0.6387225 Vali Loss: 4.7468958 Test Loss: 7.2850536
Validation loss decreased (4.810889 --> 4.746896).  Saving model ...
Updating learning rate to 6.25e-06
val 1
Fold 1 validation loss: 4.7469
--- TS-CV Fold 2/2 ---
Use CPU
train 1979
val 1
test 192
Epoch: 1 cost time: 1.443925142288208
Epoch: 1, Steps: 30 | Train Loss: 1.0551117 Vali Loss: 5.4687791 Test Loss: 7.7889752
Validation loss decreased (inf --> 5.468779).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 1.470634937286377
Epoch: 2, Steps: 30 | Train Loss: 0.7899010 Vali Loss: 4.3245091 Test Loss: 6.4507137
Validation loss decreased (5.468779 --> 4.324509).  Saving model ...
Updating learning rate to 5e-05
Epoch: 3 cost time: 1.4917490482330322
Epoch: 3, Steps: 30 | Train Loss: 0.7343968 Vali Loss: 4.0355477 Test Loss: 6.0980794
Validation loss decreased (4.324509 --> 4.035548).  Saving model ...
Updating learning rate to 2.5e-05
Epoch: 4 cost time: 1.4580092430114746
Epoch: 4, Steps: 30 | Train Loss: 0.6991013 Vali Loss: 3.9150646 Test Loss: 5.9517163
Validation loss decreased (4.035548 --> 3.915065).  Saving model ...
Updating learning rate to 1.25e-05
Epoch: 5 cost time: 1.4668190479278564
Epoch: 5, Steps: 30 | Train Loss: 0.6802761 Vali Loss: 3.8565040 Test Loss: 5.8813735
Validation loss decreased (3.915065 --> 3.856504).  Saving model ...
Updating learning rate to 6.25e-06
val 1
Fold 2 validation loss: 3.8565
Average validation loss over 2 folds: 4.3017
[I 2025-03-20 13:05:50,508] Trial 1 finished with value: 4.301699876785278 and parameters: {'d_model': 384, 'n_heads': 10, 'e_layers': 3, 'd_layers': 3, 'd_ff': 2560, 'dropout': 0.22434412751075677, 'batch_size': 64, 'activation': 'relu'}. Best is trial 0 with value: 3.903108239173889.
--- TS-CV Fold 1/2 ---
Use CPU
train 1889
val 1
test 192
	iters: 100, epoch: 1 | loss: 0.6904564
	speed: 0.0217s/iter; left time: 10.6711s
Epoch: 1 cost time: 2.5718111991882324
Epoch: 1, Steps: 118 | Train Loss: 0.4942716 Vali Loss: 1.5489048 Test Loss: 2.9617766
Validation loss decreased (inf --> 1.548905).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2085328
	speed: 0.0276s/iter; left time: 10.2786s
Epoch: 2 cost time: 2.5076239109039307
Epoch: 2, Steps: 118 | Train Loss: 0.4950743 Vali Loss: 0.9065011 Test Loss: 1.1768681
Validation loss decreased (1.548905 --> 0.906501).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1128719
	speed: 0.0278s/iter; left time: 7.0986s
Epoch: 3 cost time: 2.47416090965271
Epoch: 3, Steps: 118 | Train Loss: 0.3660154 Vali Loss: 0.6558421 Test Loss: 0.8518055
Validation loss decreased (0.906501 --> 0.655842).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4950050
	speed: 0.0292s/iter; left time: 4.0033s
Epoch: 4 cost time: 2.66860294342041
Epoch: 4, Steps: 118 | Train Loss: 0.2345500 Vali Loss: 0.9287888 Test Loss: 1.3129486
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1356709
	speed: 0.0280s/iter; left time: 0.5324s
Epoch: 5 cost time: 2.5017189979553223
Epoch: 5, Steps: 118 | Train Loss: 0.1767834 Vali Loss: 0.7560403 Test Loss: 1.2507331
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
val 1
Fold 1 validation loss: 0.6558
--- TS-CV Fold 2/2 ---
Use CPU
train 1979
val 1
test 192
	iters: 100, epoch: 1 | loss: 0.5829444
	speed: 0.0218s/iter; left time: 11.2684s
Epoch: 1 cost time: 2.7689106464385986
Epoch: 1, Steps: 123 | Train Loss: 0.4848918 Vali Loss: 1.0434645 Test Loss: 1.8620049
Validation loss decreased (inf --> 1.043465).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1336534
	speed: 0.0325s/iter; left time: 12.7874s
Epoch: 2 cost time: 2.9256668090820312
Epoch: 2, Steps: 123 | Train Loss: 0.4568050 Vali Loss: 0.8660126 Test Loss: 0.7365339
Validation loss decreased (1.043465 --> 0.866013).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1438649
	speed: 0.0335s/iter; left time: 9.0345s
Epoch: 3 cost time: 2.9896552562713623
Epoch: 3, Steps: 123 | Train Loss: 0.3716627 Vali Loss: 1.5262451 Test Loss: 0.8021091
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3692385
	speed: 0.0312s/iter; left time: 4.5913s
Epoch: 4 cost time: 2.8750410079956055
Epoch: 4, Steps: 123 | Train Loss: 0.2241378 Vali Loss: 1.7062676 Test Loss: 1.1049726
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2071464
	speed: 0.0312s/iter; left time: 0.7480s
Epoch: 5 cost time: 2.7920801639556885
Epoch: 5, Steps: 123 | Train Loss: 0.1740991 Vali Loss: 1.6053768 Test Loss: 1.1458030
EarlyStopping counter: 3 out of 3
Early stopping
val 1
Fold 2 validation loss: 0.8660
Average validation loss over 2 folds: 0.7609
[I 2025-03-20 13:06:20,544] Trial 2 finished with value: 0.7609273195266724 and parameters: {'d_model': 896, 'n_heads': 4, 'e_layers': 4, 'd_layers': 1, 'd_ff': 4096, 'dropout': 0.016984630245499843, 'batch_size': 16, 'activation': 'gelu'}. Best is trial 2 with value: 0.7609273195266724.
--- TS-CV Fold 1/2 ---
Use CPU
train 1889
val 1
test 192
Epoch: 1 cost time: 1.7313590049743652
Epoch: 1, Steps: 59 | Train Loss: 0.7550375 Vali Loss: 4.0259404 Test Loss: 5.5326494
Validation loss decreased (inf --> 4.025940).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 1.6900079250335693
Epoch: 2, Steps: 59 | Train Loss: 0.8176214 Vali Loss: 3.6863811 Test Loss: 5.0190792
Validation loss decreased (4.025940 --> 3.686381).  Saving model ...
Updating learning rate to 5e-05
Epoch: 3 cost time: 1.7477691173553467
Epoch: 3, Steps: 59 | Train Loss: 0.5962135 Vali Loss: 3.1880643 Test Loss: 4.5670258
Validation loss decreased (3.686381 --> 3.188064).  Saving model ...
Updating learning rate to 2.5e-05
Epoch: 4 cost time: 1.8048741817474365
Epoch: 4, Steps: 59 | Train Loss: 0.5106337 Vali Loss: 2.9063599 Test Loss: 4.3125741
Validation loss decreased (3.188064 --> 2.906360).  Saving model ...
Updating learning rate to 1.25e-05
Epoch: 5 cost time: 1.7511780261993408
Epoch: 5, Steps: 59 | Train Loss: 0.4664410 Vali Loss: 2.7499011 Test Loss: 4.1727391
Validation loss decreased (2.906360 --> 2.749901).  Saving model ...
Updating learning rate to 6.25e-06
val 1
Fold 1 validation loss: 2.7499
--- TS-CV Fold 2/2 ---
Use CPU
train 1979
val 1
test 192
Epoch: 1 cost time: 1.858177900314331
Epoch: 1, Steps: 61 | Train Loss: 0.7584774 Vali Loss: 3.0639188 Test Loss: 4.4502008
Validation loss decreased (inf --> 3.063919).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 1.8669679164886475
Epoch: 2, Steps: 61 | Train Loss: 0.8253542 Vali Loss: 2.9640617 Test Loss: 3.9645837
Validation loss decreased (3.063919 --> 2.964062).  Saving model ...
Updating learning rate to 5e-05
Epoch: 3 cost time: 1.7891592979431152
Epoch: 3, Steps: 61 | Train Loss: 0.5557050 Vali Loss: 2.4910440 Test Loss: 3.5638080
Validation loss decreased (2.964062 --> 2.491044).  Saving model ...
Updating learning rate to 2.5e-05
Epoch: 4 cost time: 1.7649569511413574
Epoch: 4, Steps: 61 | Train Loss: 0.4552214 Vali Loss: 2.2240574 Test Loss: 3.3420196
Validation loss decreased (2.491044 --> 2.224057).  Saving model ...
Updating learning rate to 1.25e-05
Epoch: 5 cost time: 1.7642669677734375
Epoch: 5, Steps: 61 | Train Loss: 0.4026155 Vali Loss: 2.0752006 Test Loss: 3.2225847
Validation loss decreased (2.224057 --> 2.075201).  Saving model ...
Updating learning rate to 6.25e-06
val 1
Fold 2 validation loss: 2.0752
Average validation loss over 2 folds: 2.4126
[I 2025-03-20 13:06:41,255] Trial 3 finished with value: 2.4125508069992065 and parameters: {'d_model': 768, 'n_heads': 8, 'e_layers': 4, 'd_layers': 2, 'd_ff': 1024, 'dropout': 0.48808792212377144, 'batch_size': 32, 'activation': 'gelu'}. Best is trial 2 with value: 0.7609273195266724.
--- TS-CV Fold 1/2 ---
Use CPU
train 1889
val 1
test 192
Epoch: 1 cost time: 1.9377970695495605
Epoch: 1, Steps: 59 | Train Loss: 0.7798519 Vali Loss: 4.2750969 Test Loss: 6.4357810
Validation loss decreased (inf --> 4.275097).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 1.787106990814209
Epoch: 2, Steps: 59 | Train Loss: 0.8246660 Vali Loss: 3.8847241 Test Loss: 5.5788263
Validation loss decreased (4.275097 --> 3.884724).  Saving model ...
Updating learning rate to 5e-05
Epoch: 3 cost time: 1.7355577945709229
Epoch: 3, Steps: 59 | Train Loss: 0.5966113 Vali Loss: 3.3339429 Test Loss: 4.9686779
Validation loss decreased (3.884724 --> 3.333943).  Saving model ...
Updating learning rate to 2.5e-05
Epoch: 4 cost time: 1.7459940910339355
Epoch: 4, Steps: 59 | Train Loss: 0.5133910 Vali Loss: 3.0217125 Test Loss: 4.6281478
Validation loss decreased (3.333943 --> 3.021713).  Saving model ...
Updating learning rate to 1.25e-05
Epoch: 5 cost time: 1.786133050918579
Epoch: 5, Steps: 59 | Train Loss: 0.4693941 Vali Loss: 2.8510809 Test Loss: 4.4458175
Validation loss decreased (3.021713 --> 2.851081).  Saving model ...
Updating learning rate to 6.25e-06
val 1
Fold 1 validation loss: 2.8511
--- TS-CV Fold 2/2 ---
Use CPU
train 1979
val 1
test 192
Epoch: 1 cost time: 1.883051872253418
Epoch: 1, Steps: 61 | Train Loss: 0.8299656 Vali Loss: 3.5980232 Test Loss: 4.8450040
Validation loss decreased (inf --> 3.598023).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 1.8616981506347656
Epoch: 2, Steps: 61 | Train Loss: 0.8235827 Vali Loss: 3.3224311 Test Loss: 4.1529243
Validation loss decreased (3.598023 --> 3.322431).  Saving model ...
Updating learning rate to 5e-05
Epoch: 3 cost time: 2.0148208141326904
Epoch: 3, Steps: 61 | Train Loss: 0.5902374 Vali Loss: 2.9379354 Test Loss: 3.6512253
Validation loss decreased (3.322431 --> 2.937935).  Saving model ...
Updating learning rate to 2.5e-05
Epoch: 4 cost time: 1.799746036529541
Epoch: 4, Steps: 61 | Train Loss: 0.4897128 Vali Loss: 2.7004402 Test Loss: 3.3508931
Validation loss decreased (2.937935 --> 2.700440).  Saving model ...
Updating learning rate to 1.25e-05
Epoch: 5 cost time: 1.8707661628723145
Epoch: 5, Steps: 61 | Train Loss: 0.4348496 Vali Loss: 2.5619564 Test Loss: 3.1864971
Validation loss decreased (2.700440 --> 2.561956).  Saving model ...
Updating learning rate to 6.25e-06
val 1
Fold 2 validation loss: 2.5620
Average validation loss over 2 folds: 2.7065
[I 2025-03-20 13:07:02,806] Trial 4 finished with value: 2.7065186500549316 and parameters: {'d_model': 896, 'n_heads': 2, 'e_layers': 2, 'd_layers': 2, 'd_ff': 2048, 'dropout': 0.4667385901088441, 'batch_size': 32, 'activation': 'gelu'}. Best is trial 2 with value: 0.7609273195266724.
Best hyperparameters: {'d_model': 896, 'n_heads': 4, 'e_layers': 4, 'd_layers': 1, 'd_ff': 4096, 'dropout': 0.016984630245499843, 'batch_size': 16, 'activation': 'gelu'}
Final training model
Use CPU
train 2069
val 192
test 192
	iters: 100, epoch: 1 | loss: 0.5689127
	speed: 0.0218s/iter; left time: 11.8841s
Epoch: 1 cost time: 2.822317123413086
Epoch: 1, Steps: 129 | Train Loss: 0.4105404 Vali Loss: 0.2607519 Test Loss: 0.5093162
Validation loss decreased (inf --> 0.260752).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0987749
	speed: 0.0341s/iter; left time: 14.2119s
Epoch: 2 cost time: 2.849565029144287
Epoch: 2, Steps: 129 | Train Loss: 0.4419242 Vali Loss: 0.2904136 Test Loss: 0.1732204
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2722777
	speed: 0.0357s/iter; left time: 10.2840s
Epoch: 3 cost time: 2.998023271560669
Epoch: 3, Steps: 129 | Train Loss: 0.3741684 Vali Loss: 0.5945890 Test Loss: 0.4135275
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5270577
	speed: 0.0342s/iter; left time: 5.4359s
Epoch: 4 cost time: 2.85870099067688
Epoch: 4, Steps: 129 | Train Loss: 0.2080529 Vali Loss: 0.6794217 Test Loss: 0.7628090
EarlyStopping counter: 3 out of 3
Early stopping
test 192
preds shape:  (192, 1, 90, 1)
trues shape:  (192, 1, 90, 1)
mape:0.0760, mae:148.68, d_stat:47.24
Final model training and testing complete.
