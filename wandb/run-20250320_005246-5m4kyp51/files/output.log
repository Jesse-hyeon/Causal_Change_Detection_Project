[I 2025-03-20 00:52:46,809] A new study created in memory with name: no-name-04975419-8375-439a-b31d-eda2d3649de5
--- TS-CV Fold 1/1 ---
Use CPU
train 1979
val 1
test 192
Epoch: 1 cost time: 1.9136497974395752
Epoch: 1, Steps: 30 | Train Loss: 0.9769697 Vali Loss: 5.1247110 Test Loss: 7.9042597
Validation loss decreased (inf --> 5.124711).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 1.5483920574188232
Epoch: 2, Steps: 30 | Train Loss: 0.7044228 Vali Loss: 3.7764485 Test Loss: 6.6092507
Validation loss decreased (5.124711 --> 3.776448).  Saving model ...
Updating learning rate to 5e-05
Epoch: 3 cost time: 1.3854789733886719
Epoch: 3, Steps: 30 | Train Loss: 0.6415604 Vali Loss: 3.4230025 Test Loss: 6.3238939
Validation loss decreased (3.776448 --> 3.423002).  Saving model ...
Updating learning rate to 2.5e-05
Epoch: 4 cost time: 1.4080841541290283
Epoch: 4, Steps: 30 | Train Loss: 0.5988005 Vali Loss: 3.2615194 Test Loss: 6.2053513
Validation loss decreased (3.423002 --> 3.261519).  Saving model ...
Updating learning rate to 1.25e-05
Epoch: 5 cost time: 1.4149887561798096
Epoch: 5, Steps: 30 | Train Loss: 0.5765116 Vali Loss: 3.1795917 Test Loss: 6.1463397
Validation loss decreased (3.261519 --> 3.179592).  Saving model ...
Updating learning rate to 6.25e-06
val 1
Fold 1 validation loss: 3.1796
Average validation loss over 1 folds: 3.1796
[I 2025-03-20 00:52:55,976] Trial 0 finished with value: 3.179591655731201 and parameters: {'d_model': 640, 'n_heads': 8, 'e_layers': 2, 'd_layers': 1, 'd_ff': 3072, 'dropout': 0.016841320016836747, 'batch_size': 64, 'activation': 'relu'}. Best is trial 0 with value: 3.179591655731201.
Best hyperparameters: {'d_model': 640, 'n_heads': 8, 'e_layers': 2, 'd_layers': 1, 'd_ff': 3072, 'dropout': 0.016841320016836747, 'batch_size': 64, 'activation': 'relu'}
Final training model
Use CPU
train 2069
val 192
test 192
Epoch: 1 cost time: 1.5865700244903564
Epoch: 1, Steps: 32 | Train Loss: 1.1711542 Vali Loss: 5.1477446 Test Loss: 7.6950429
Validation loss decreased (inf --> 5.147745).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 1.536881923675537
Epoch: 2, Steps: 32 | Train Loss: 0.8371785 Vali Loss: 3.8084446 Test Loss: 6.3551097
Validation loss decreased (5.147745 --> 3.808445).  Saving model ...
Updating learning rate to 5e-05
Epoch: 3 cost time: 1.7978761196136475
Epoch: 3, Steps: 32 | Train Loss: 0.7596982 Vali Loss: 3.4425526 Test Loss: 6.0537573
Validation loss decreased (3.808445 --> 3.442553).  Saving model ...
Updating learning rate to 2.5e-05
Epoch: 4 cost time: 1.6731460094451904
Epoch: 4, Steps: 32 | Train Loss: 0.7054128 Vali Loss: 3.2758680 Test Loss: 5.9300121
Validation loss decreased (3.442553 --> 3.275868).  Saving model ...
Updating learning rate to 1.25e-05
Epoch: 5 cost time: 1.5382051467895508
Epoch: 5, Steps: 32 | Train Loss: 0.6760961 Vali Loss: 3.1925180 Test Loss: 5.8699515
Validation loss decreased (3.275868 --> 3.192518).  Saving model ...
Updating learning rate to 6.25e-06
test 192
preds shape:  (192, 1, 90, 1)
trues shape:  (192, 1, 90, 1)
mape:0.2869, mae:557.30, d_stat:51.76
Final model training and testing complete.
